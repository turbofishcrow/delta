<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <script src="fdr.js"></script>
    <script src="pdr.js" defer></script>
    <script src="index.js" defer></script>
    <div class="normal">
      <h1>DR chord explorer</h1>

      Build DR chords and compute the error of any chord from a target DR chord.
      <hr />
      Made by inthar. The source code is available on
      <a href="https://github.com/inthar-raven/delta" target="_blank"
        >GitHub</a
      >.
      <table>
        <tr>
          <td>
            <hr/>
            <label for="input-base-frequency"
              ><strong>Base frequency</strong> (in Hz, default 220)</label
            >
            <input
              type="number"
              id="input-base-frequency"
              name="input-base-frequency"
              value="220"
              style="width: 80px"
            />
            <hr />
            <div id="audio-controls">
              <strong>Playback</strong>
              <button id="btn-play-chord">▶ Play</button>
              <button id="btn-stop-chord">⏹ Stop</button>
              &nbsp;&nbsp;
              <label for="waveform-select"><strong>Waveform:</strong></label>
              <select id="waveform-select">
                <option value="sine">Sine</option>
                <option value="triangle">Triangle</option>
                <option value="semisine">Semisine</option>
                <option value="square">Square</option>
                <option value="sawtooth">Saw</option>
              </select>
            </div>
            <hr />
            <strong>Add/Remove intervals</strong>
            <br/>
            <button id="btn-add-interval">Append +1</button>
            <button id="btn-remove-interval">Remove last</button>
            <button id="btn-clear-intervals">Keep first only</button>
            <hr />
            <strong>Global update</strong>
            <br/>
            <button id="btn-recalc-deltas">Update from all intervals (recalc deltas)</button>
            <button id="btn-update-from-deltas">Update from all deltas (keep outer interval)</button>
            <hr />
            <strong>Intervals</strong>
            <table id="intervals">
              <tr>
                <td>
                  <input
                    type="text"
                    id="input-interval-1-cents"
                    name="input-interval-1-cents"
                    value="400.0"
                    style="width: 80px"
                  />
                  Interval (cents or a\n, from root)
                  <br/>
                  <input
                    type="text"
                    id="input-interval-1-ratio"
                    name="input-interval-1-ratio"
                    style="width: 80px"
                  />
                  Ratio (from root)
                  <br/>
                  <button id="btn-update-interval-1">Update (keep deltas)</button>
                  <br/>
                  <input
                    type="number"
                    id="input-interval-1-delta"
                    name="input-interval-1-delta"
                    value="1"
                    style="width: 80px"
                  />
                  Delta
                  <button id="btn-update-delta-1">Update (keep other deltas)</button>
                </td>
                <td>
                  <input
                    type="number"
                    id="input-interval-1-target-delta"
                    name="input-interval-1-target-delta"
                    value="1"
                    style="width: 80px"
                  />
                  Target delta
                  <br/>
                  <input
                    type="checkbox"
                    id="input-interval-1-free"
                    name="input-interval-1-free"
                  />
                  Free (+?)
                </td>
              </tr>
            </table>
          </td>
          <td class="visualization-column">
            <div class="mobile-drag-handle">
              <div class="drag-handle-bar"></div>
            </div>
            <hr/>
            <div id="visualization">
              <strong>Chord Visualization</strong>
              <div id="viz-controls">
                <strong>Window size:</strong>
                <label for="viz-window">Ratio</label>
                <input type="text" id="viz-window" value="2/1" style="width: 60px" />
                <label for="viz-window-cents" style="margin-left: 10px;">Cents</label>
                <input type="text" id="viz-window-cents" value="1200" style="width: 60px" />
                <button id="btn-update-viz">Update</button>
              </div>
              <div id="viz-container">
                <div class="viz-panel">
                  <div class="viz-label">Linear (frequency space)</div>
                  <svg id="viz-linear" width="100%" height="60"></svg>
                </div>
                <div class="viz-panel">
                  <div class="viz-label">Logarithmic (pitch space)</div>
                  <svg id="viz-log" width="100%" height="60"></svg>
                </div>
              </div>
              </div>
              <hr />
              <div id="error-display">
                <strong>Error</strong>
                <div style="margin: 6px 0;">
                  <label for="error-domain">Domain:</label>
                  <select id="error-domain">
                    <option value="linear">Linear</option>
                    <option value="log" selected>Logarithmic</option>
                  </select>
                  <label for="error-model" style="margin-left: 10px;">Error model:</label>
                  <select id="error-model">
                    <option value="rooted">Rooted (from root)</option>
                    <option value="pairwise" selected>Pairwise (all intervals)</option>
                    <option value="all-steps">All-steps (successive only)</option>
                  </select>
                </div>
                <button id="btn-calculate-error">Calculate</button>
                <button id="btn-clear-target">Clear target</button>
                <br/>
                <span id="ls-error"></span>
              </div>
            </div>
          </td>
        </tr>
      </table>
    </div>
  </body>
</html>
